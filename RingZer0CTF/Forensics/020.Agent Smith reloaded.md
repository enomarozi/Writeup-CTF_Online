<h1>Agent Smith reloaded</h1>
<h3>Description</h3>
<pre>
<a href="https://ringzer0ctf.com/files/2b4d08e1a1eac8a8c9034036d420bd88.zip">File</a>
</pre>
<h3>Solution</h3>
<p>File merupakan extended file system3 linux, ekstrak file dengan foremost</p>

```console
┌──(root㉿Kali)-[/home/venom/Downloads]
└─# file BK  
BK: Linux rev 1.0 ext3 filesystem data, UUID=ca014691-c6ea-4a5a-8da4-74a1aa1c9a80
```
<p>Foremost file BK</p>

```console
┌──(root㉿Kali)-[/home/venom/Downloads]
└─# foremost BK 
Processing: BK
|foundat=mimetypeapplication/vnd.oasis.opendocument.graphicsPK
foundat=meta.xml���n�0��}
��
6���D���"��T�m��ld��}��6�]E{�������Ǯ�޸6B�
�	�T1!�
�z~���}��T//�r�:.m�qK"'�O�

ZbE�0X��)V=���i␦M�c+��
�Z��qL��D������2z��A��b���I
�;�֔gזz͍�r]��f]K)u2�e�
foundat=mimetypeapplication/vnd.oasis.opendocument.graphicsPK
foundat=meta.xml���n�0��}
��
6���D���"��T�m��ld��}��6�]E{�������Ǯ�޸6B�
�	�T1!�
�z~���}��T//�r�:.m�qK"'�O�

ZbE�0X��)V=���i␦M�c+��
�Z��qL��D������2z��A��b���I
�;�֔gזz͍�r]��f]K)u2�e�
*|
                                                                                                                                                  
┌──(root㉿Kali)-[/home/venom/Downloads]
└─# ls
2b4d08e1a1eac8a8c9034036d420bd88.zip  BK  output
```
<p>Perbaiki Zip</p>

```console
┌──(root㉿Kali)-[/home/venom/Downloads/output/zip]
└─# zip -F 00002456.zip --out fixed.zip 
Fix archive (-F) - assume mostly intact archive
Zip entry offsets appear off by 1024 bytes - correcting...
 copying: secret.txt

┌──(root㉿Kali)-[/home/venom/Downloads/output/zip]
└─# zip -T fixed.zip                   
[fixed.zip] secret.txt password: test of fixed.zip FAILED

zip error: Zip file invalid, could not spawn unzip, or wrong unzip (original files unmodified)
```
<p>Dump Hash zip</p>

```console
┌──(root㉿Kali)-[/home/venom/Downloads/output/zip]
└─# zip2john fixed.zip           
ver 2.0 efh 5455 efh 7875 fixed.zip/secret.txt PKZIP Encr: TS_chk, cmplen=26, decmplen=16, crc=EE8F939A ts=A421 cs=a421 type=8
fixed.zip/secret.txt:$pkzip$1*1*2*0*1a*10*ee8f939a*400*44*8*1a*a421*bab041197a7d69df7197aa75bbb5fac22c908a0d999a2b85e162*$/pkzip$:secret.txt:fixed.zip::fixed.zip
                                                                                                                                                  
┌──(root㉿Kali)-[/home/venom/Downloads/output/zip]
└─# zip2john fixed.zip > hashdump_zip
ver 2.0 efh 5455 efh 7875 fixed.zip/secret.txt PKZIP Encr: TS_chk, cmplen=26, decmplen=16, crc=EE8F939A ts=A421 cs=a421 type=8
```
<p>Bruteforce ZIP</p>

```console
┌──(root㉿Kali)-[/home/venom/Downloads/output/zip]
└─# john --wordlist=/usr/share/wordlists/rockyou.txt hashdump_zip            
Using default input encoding: UTF-8
Loaded 1 password hash (PKZIP [32/64])
Will run 4 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
12345            (fixed.zip/secret.txt)     
1g 0:00:00:00 DONE (2025-11-29 13:27) 100.0g/s 819200p/s 819200c/s 819200C/s 123456..whitetiger
Use the "--show" option to display all of the cracked passwords reliably
Session completed.
┌──(root㉿Kali)-[/home/venom/Downloads/output/zip]
└─# unzip fixed.zip   
Archive:  fixed.zip
[fixed.zip] secret.txt password: 
  inflating: secret.txt              
                                                                                                                                                  
┌──(root㉿Kali)-[/home/venom/Downloads/output/zip]
└─# cat secret.txt 
FLAG-menummenum
```
<h3>Flag</h3>
<pre>
FLAG-menummenum
</pre>
