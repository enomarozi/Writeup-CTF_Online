<h1>Someone steal my flag!</h1>
<h3>Description</h3>
<pre>
<a href="https://ringzer0ctf.com/files/bdc8c86f1c082715762b4d9cb755c4c7.zip">File</a>
</pre>
<h3>Solution</h3>
<p>DNS Query data</p>
<p><b>ip.dst == 192.168.191.129 && dns && ip.src == 192.168.191.128 && !icmp</b></p> 
<p align="center">
  <img src="https://github.com/enomarozi/RSA-CTF-Writeup/blob/master/Wireshark/Images/Someonesteal.png">
</p>
<p>Berikut script get dns query</p>

```python
from scapy.all import *
from base64 import b64decode

packets = rdpcap("6338c3e33776b9844814d2daadf208bc.pcap")
result = ''
for pkt in packets:
    if pkt.haslayer("DNS") and pkt.haslayer(IP):
        if pkt[IP].src == "192.168.191.128" and pkt[IP].dst == "192.168.191.129":
            if not pkt.haslayer(ICMP):
                data_pkt = pkt['DNS']['DNS Question Record'].qname.decode().split('.')[0]
                if data_pkt not in result:
                    result += data_pkt
                
bytes_decode = bytes.fromhex(result)
flag = b64decode(bytes_decode)
print(flag.decode().split(' ')[-1])
```

<h3>Flag</h3>
<pre>
FLAG-FT47cMX26pWyFSI6RPWaSr5YRw
</pre>
