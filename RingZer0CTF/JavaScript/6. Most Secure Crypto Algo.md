<h1>Most Secure Crypto Algo</h1>
<h3>Description</h3>
<p>https://ringzer0ctf.com/challenges/67</p>
<h3>Solution</h3>
<label>View source halaman, dan cek javascript challenge</label>

```javascript
$(".c_submit").click(function(event) {
  event.preventDefault();
  var k = CryptoJS.SHA256("\x93\x39\x02\x49\x83\x02\x82\xf3\x23\xf8\xd3\x13\x37");
  var u = $("#cuser").val();
  var p = $("#cpass").val();
  var t = true;

  if(u == "\x68\x34\x78\x30\x72") {
    if(!CryptoJS.AES.encrypt(p, CryptoJS.enc.Hex.parse(k.toString().substring(0,32)), { iv: CryptoJS.enc.Hex.parse(k.toString().substring(32,64)) }) == "ob1xQz5ms9hRkPTx+ZHbVg==") {
      t = false;
    }
  } else {
    $("#cresponse").html("<div class='alert alert-danger'>Wrong password sorry.</div>");
    t = false;
  }
  if(t) {
    if(document.location.href.indexOf("?p=") == -1) {
      document.location = document.location.href + "?p=" + p;
              }
  }
});
```
<label>Karna Key, IV dan Ciphertext didapatkan, berikut solve javascriptnya</label>

```javascript
var username = '\x68\x34\x78\x30\x72' 
console.log(`Username : ${username}`);
var k = CryptoJS.SHA256("\x93\x39\x02\x49\x83\x02\x82\xf3\x23\xf8\xd3\x13\x37");
var key = CryptoJS.enc.Hex.parse(k.toString().substring(0, 32));
var iv = CryptoJS.enc.Hex.parse(k.toString().substring(32,64));
var ciphertext = 'ob1xQz5ms9hRkPTx+ZHbVg==' 
var plaintext = CryptoJS.AES.decrypt(ciphertext,key,{iv:iv});
console.log(`Password : ${CryptoJS.enc.Utf8.stringify(plaintext)}`);
```
<pre>
Username : h4x0r
Password : PassW0RD!289%!*
</pre>
<h3>Flag</h3>
<pre>
FLAG-gYtLBa66178DG7l28Uu5lW45CR
</pre>
