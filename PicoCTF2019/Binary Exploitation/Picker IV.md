<h1>Picker IV</h1>
<h3>Description</h3>
<pre>
Can you figure out how this program works to get the flag?
Connect to the program with netcat:
$ nc saturn.picoctf.net 59622
The program's source code can be downloaded <a href='https://artifacts.picoctf.net/c/528/picker-IV.c'>here</a>. The binary can be downloaded <a href='https://artifacts.picoctf.net/c/528/picker-IV'>here</a>.
</pre>
<h3>Solution</h3>

```c
┌──(root㉿Kali)-[/home/venom/Downloads]
└─# cat picker-IV.c 
#include <stdio.h>
#include <stdlib.h>
#include <signal.h>
#include <unistd.h>


void print_segf_message(){
  printf("Segfault triggered! Exiting.\n");
  sleep(15);
  exit(SIGSEGV);
}

int win() {
  FILE *fptr;
  char c;

  printf("You won!\n");
  // Open file
  fptr = fopen("flag.txt", "r");
  if (fptr == NULL)
  {
      printf("Cannot open file.\n");
      exit(0);
  }

  // Read contents from file
  c = fgetc(fptr);
  while (c != EOF)
  {
      printf ("%c", c);
      c = fgetc(fptr);
  }

  printf("\n");
  fclose(fptr);
}

int main() {
  signal(SIGSEGV, print_segf_message);
  setvbuf(stdout, NULL, _IONBF, 0); // _IONBF = Unbuffered

  unsigned int val;
  printf("Enter the address in hex to jump to, excluding '0x': ");
  scanf("%x", &val);
  printf("You input 0x%x\n", val);

  void (*foo)(void) = (void (*)())val;
  foo();
}
```
<pre>
printf("Enter the address in hex to jump to, excluding '0x': ");
scanf("%x", &val);
</pre>
<label>input alamat untuk jump ke alamat tersebut</label>
<pre>
void (*foo)(void) = (void (*)())val;
foo();
</pre>
<label>alamat fungsi yg akan di jump dan bernama fungsi foo()</label>
```console
┌──(root㉿Kali)-[/home/venom/Downloads]
└─# nc saturn.picoctf.net 59622
Enter the address in hex to jump to, excluding '0x': 000000000040129e
You input 0x40129e
You won!
picoCTF{n3v3r_jump_t0_u53r_5uppl13d_4ddr35535_14bc5444}
```
<h3>Flag</h3>
<pre>
picoCTF{n3v3r_jump_t0_u53r_5uppl13d_4ddr35535_14bc5444}
</pre>
