<h1>seed-sPRiNG</h1>
<h3>Description</h3>
<pre>
The most revolutionary game is finally available: <a href='https://challenge-files.picoctf.net/c_fickle_tempest/0f0e5b0e92d23b6e089ef6e41e087daa4296556341542a88de15ae1bbd0159d6/seed_spring'>seed sPRiNG</a> is open right now!
Seed sPRiNG is available atseed_spring. Connect to it with nc fickle-tempest.picoctf.net 50522.
</pre>
<h3>Solution</h3>
<label>Reverse dengan ghidra</label>

```c
undefined4 main(void)

{
  uint local_20;
  uint local_1c;
  uint local_18;
  int local_14;
  undefined1 *local_10;
  
  local_10 = &stack0x00000004;
  puts("");
  puts("");
  puts("                                                                             ");
  puts("                          #                mmmmm  mmmmm    \"    mm   m   mmm ");
  puts("  mmm    mmm    mmm    mmm#          mmm   #   \"# #   \"# mmm    #\"m  # m\"   \"");
  puts(" #   \"  #\"  #  #\"  #  #\" \"#         #   \"  #mmm#\" #mmmm\"   #    # #m # #   mm");
  puts(
      "  \"\"\"m  #\"\"\"\"  #\"\"\"\"  #   #          \"\"\"m  #      #   \"m   #    #  # # #    #"
      );
  puts(" \"mmm\"  \"#mm\"  \"#mm\"  \"#m##         \"mmm\"  #      #    \" mm#mm  #   ##  \"mmm\"");
  puts("                                                                             ");
  puts("");
  puts("");
  puts("Welcome! The game is easy: you jump on a sPRiNG.");
  puts("How high will you fly?");
  puts("");
  fflush(_stdout);
  local_18 = time((time_t *)0x0);
  srand(local_18);
  local_14 = 1;
  while( true ) {
    if (0x1e < local_14) {
      puts("Congratulation! You\'ve won! Here is your flag:\n");
      fflush(_stdout);
      get_flag();
      fflush(_stdout);
      return 0;
    }
    printf("LEVEL (%d/30)\n",local_14);
    puts("");
    local_1c = rand();
    local_1c = local_1c & 0xf;
    printf("Guess the height: ");
    fflush(_stdout);
    __isoc99_scanf(&DAT_00010caa,&local_20);
    fflush(_stdin);
    if (local_1c != local_20) break;
    local_14 = local_14 + 1;
  }
  puts("WRONG! Sorry, better luck next time!");
  fflush(_stdout);
                    /* WARNING: Subroutine does not return */
  exit(-1);
}
```
<label>Fungsi generate random, srand-nya dari fungsi time(NULL) yaitu epoch time sekarang

```c
local_18 = time((time_t *)0x0);
srand(local_18);
```
```c
local_1c = local_1c & 0xf;
printf("Guess the height: ");
```
<label>Dan tebak-tebakan angka yaitu (nilai random & 0xf), yang kemungkinan ada 16 angka (0 s/d 15) sebanyak 30 kali benar berturut-turut maka mendapatkan flag</label>
<label>Berikut program solve C dan CPython (nilai random masing2 bahasa pemograman umumnya berbeda hasil generatenya walaupun seeder/srand-nya sama)</label>

```c
#include <stdio.h>
#include <time.h>
#include <stdlib.h>
int main ()
{
    int i;
    srand(time(0));
    for (i = 0; i < 30; i++)
    {
        printf("%d\n", rand() & 0xf);
    }
    return 0;
}
```

```cpython
import ctypes, time

libc = ctypes.CDLL("libc.so.6")
seed = int(time.time())
libc.srand(seed)

for i in range(31):
    print(libc.rand() & 0xf)
```

<label>Hasil</label>

```console
┌──(root㉿Venom)-[/home/venom/Downloads]
└─# python3 cpython.py | nc fickle-tempest.picoctf.net 50522


                                                                             
                          #                mmmmm  mmmmm    "    mm   m   mmm 
  mmm    mmm    mmm    mmm#          mmm   #   "# #   "# mmm    #"m  # m"   "
 #   "  #"  #  #"  #  #" "#         #   "  #mmm#" #mmmm"   #    # #m # #   mm
  """m  #""""  #""""  #   #          """m  #      #   "m   #    #  # # #    #
 "mmm"  "#mm"  "#mm"  "#m##         "mmm"  #      #    " mm#mm  #   ##  "mmm"
                                                                             


Welcome! The game is easy: you jump on a sPRiNG.
How high will you fly?

LEVEL (1/30)

Guess the height: LEVEL (2/30)

Guess the height: LEVEL (3/30)

Guess the height: LEVEL (4/30)

Guess the height: LEVEL (5/30)

Guess the height: LEVEL (6/30)

Guess the height: LEVEL (7/30)

Guess the height: LEVEL (8/30)

Guess the height: LEVEL (9/30)

Guess the height: LEVEL (10/30)

Guess the height: LEVEL (11/30)

Guess the height: LEVEL (12/30)

Guess the height: LEVEL (13/30)

Guess the height: LEVEL (14/30)

Guess the height: LEVEL (15/30)

Guess the height: LEVEL (16/30)

Guess the height: LEVEL (17/30)

Guess the height: LEVEL (18/30)

Guess the height: LEVEL (19/30)

Guess the height: LEVEL (20/30)

Guess the height: LEVEL (21/30)

Guess the height: LEVEL (22/30)

Guess the height: LEVEL (23/30)

Guess the height: LEVEL (24/30)

Guess the height: LEVEL (25/30)

Guess the height: LEVEL (26/30)

Guess the height: LEVEL (27/30)

Guess the height: LEVEL (28/30)

Guess the height: LEVEL (29/30)

Guess the height: LEVEL (30/30)

Guess the height: Congratulation! You've won! Here is your flag:

picoCTF{pseudo_random_number_generator_not_so_random_5F1Ba8BB}
```
<h3>Flag</h3>
<pre>
picoCTF{pseudo_random_number_generator_not_so_random_5F1Ba8BB}
</pre>
